<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Approval Table</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/approval.css" />
    <!-- Modal CSS -->
    <link rel="stylesheet" href="assets/css/merchant-modal.css" />
    <link rel="stylesheet" href="assets/css/pemol-modal.css" />
  </head>

  <body class="body-rsm">
    <div class="card-rsm">
      <!-- TOP BAR -->
      <div
        class="d-flex align-items-center justify-content-between rsm-top-bar"
      >
        <div class="d-flex align-items-center gap-3 w-100">
          <!-- search -->
          <div class="rsm-search-component-container w-100"></div>
        </div>

        <!-- Filter / Export Area if needed, currently just empty or standard -->
      </div>

      <!-- TABLE -->
      <div class="table-responsive">
        <table class="table mb-0 rsm-table text-nowrap">
          <thead>
            <tr class="align-middle">
              <th class="text-center" style="width: 50px">No</th>
              <th class="text-center">Request ID</th>
              <th class="text-center">Name</th>
              <th class="text-center">Product</th>
              <th class="text-center">Area</th>
              <th class="text-center">Position</th>
              <th class="text-center">Level</th>
              <th class="text-center">SPV Name</th>
              <th class="text-center">Status</th>
              <th class="text-center">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center">1</td>
              <td class="text-center">REQ001</td>
              <td class="rsm-name-cell">John Doe</td>
              <td class="text-center">CC</td>
              <td class="text-center">Jakarta</td>
              <td class="text-center">Sales</td>
              <td class="text-center">Staff</td>
              <td class="text-center">Supervisor A</td>
              <td class="text-center">
                <span class="badge bg-warning text-dark">Pending</span>
              </td>
              <td class="text-center">
                <button
                  class="btn-merchant-action"
                  onclick="window.openApprovalModal && window.openApprovalModal()"
                >
                  <!-- simple dots icon or eye icon -->
                  <svg
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <circle cx="12" cy="12" r="2" fill="#29415C" />
                    <circle cx="19" cy="12" r="2" fill="#29415C" />
                    <circle cx="5" cy="12" r="2" fill="#29415C" />
                  </svg>
                </button>
              </td>
            </tr>
            <tr>
              <td class="text-center">2</td>
              <td class="text-center">REQ002</td>
              <td class="rsm-name-cell">Jane Smith</td>
              <td class="text-center">PL</td>
              <td class="text-center">Bandung</td>
              <td class="text-center">Admin</td>
              <td class="text-center">Senior</td>
              <td class="text-center">Supervisor B</td>
              <td class="text-center">
                <span class="badge bg-success">Approved</span>
              </td>
              <td class="text-center">
                <button
                  class="btn-merchant-action"
                  onclick="window.openApprovalModal && window.openApprovalModal()"
                >
                  <svg
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <circle cx="12" cy="12" r="2" fill="#29415C" />
                    <circle cx="19" cy="12" r="2" fill="#29415C" />
                    <circle cx="5" cy="12" r="2" fill="#29415C" />
                  </svg>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- FOOTER / PAGINATION -->
      <div class="rsm-pagination-component-container"></div>

      <script>
        // Load Pagination
        fetch("assets/partials/components/pagination.html")
          .then((response) => response.text())
          .then((html) => {
            document
              .querySelectorAll(".rsm-pagination-component-container")
              .forEach((container) => {
                if (container.innerHTML.trim() === "") {
                  container.innerHTML = html;
                }
              });
          });

        // Load Search Component
        fetch("assets/partials/components/search.html")
          .then((response) => response.text())
          .then((html) => {
            document
              .querySelectorAll(".rsm-search-component-container")
              .forEach((container) => {
                if (container.innerHTML.trim() === "") {
                  container.innerHTML = html;
                }
              });
          });
      </script>

      <!-- Container for the Modal Partial -->
      <div id="approvalModalContainer"></div>

      <script>
        // Load the modal partial dynamically
        fetch("assets/partials/approval_modal.html")
          .then((r) => r.text())
          .then((html) => {
            const container = document.getElementById("approvalModalContainer");
            if (!container) return;

            // Basic cleanup of previous modals if needed (adjust IDs as per approval_modal content)
            const oldModal = document.getElementById("approvalDetailModal");
            if (oldModal) oldModal.remove();

            container.innerHTML = html;

            // Move modal to body if it exists
            const modal = document.getElementById("approvalDetailModal");
            if (modal) document.body.appendChild(modal);

            // Execute scripts in partial
            const scripts = container.querySelectorAll("script");
            scripts.forEach((s) => {
              const ns = document.createElement("script");
              ns.textContent = s.textContent;
              document.body.appendChild(ns);
            });
          });
      </script>
    </div>
  </body>
</html>
