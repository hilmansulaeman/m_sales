<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Incoming Mobile Sales Table - Bootstrap</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="assets/css/perf-table.css" />
  <!-- Modal CSS -->
  <link rel="stylesheet" href="assets/css/merchant-modal.css" />
  <link rel="stylesheet" href="assets/css/pemol-modal.css" />
</head>

<body class="body-rsm">
  <div class="card-rsm">
    <!-- TOP BAR -->
    <div class="d-flex align-items-center justify-content-between rsm-top-bar">
      <div class="d-flex align-items-center gap-3">
        <!-- search -->
        <div class="input-group rsm-search-input">
          <span class="input-group-text">üîç</span>
          <input type="text" class="form-control" placeholder="Cari" />
        </div>

        <!-- SOURCE FILTER -->
        <div class="btn-group rsm-source-filter" role="group" aria-label="Source filter">
          <span class="btn rsm-source-label">Source</span>
          <button type="button" class="btn dropdown-toggle rsm-source-dropdown btn-source-trigger">
            All product
          </button>
        </div>

        <!-- date range wrapper (Component) -->
        <div id="rsmDateComponentContainer"></div>
        <script>
          fetch('assets/partials/components/date_picker.html')
            .then(response => response.text())
            .then(html => {
              const container = document.getElementById('rsmDateComponentContainer');
              if (container) {
                container.innerHTML = html;
                // Execute scripts found in the component
                container.querySelectorAll('script').forEach(oldScript => {
                  const newScript = document.createElement('script');
                  newScript.textContent = oldScript.textContent;
                  document.body.appendChild(newScript);
                });
              }
            });
        </script>
      </div>

      <!-- export -->
      <button class="btn d-flex align-items-center gap-2 px-4 py-2 btn-export-rsm btn-export-trigger">
        ‚¨á
        <span>Ekspor data</span>
      </button>
    </div>

    <!-- TABLE -->
    <div class="table-responsive">
      <table class="table mb-0 rsm-table text-nowrap">
        <thead>
          <tr>
            <th class="text-center" style="width: 60px">No</th>
            <th style="width: 25%">RSM Name</th>
            <th class="text-center">NIK Sales</th>
            <th class="text-center">Branch</th>
            <th class="text-center">Total DSR Active</th>
            <th class="text-center">Submit BCA</th>
            <th class="text-center">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-center">1</td>
            <td class="rsm-name-cell">Ramaldo Oktama</td>
            <td class="text-center">K1104148</td>

            <td class="text-center">3</td>
            <td class="text-center">1</td>
            <td class="text-center">0</td>

            <!-- Action -->
            <td class="text-center rsm-action-cell">
              <button class="btn btn-sm rsm-circle-btn btn-merchant-action">
                <img src="assets/img/icon/view1.svg" alt="More">

              </button>
            </td>
          </tr>

          <tr>
            <td class="text-center">2</td>
            <td class="rsm-name-cell">Asep Syaefudin</td>
            <td class="text-center">K1200215</td>

            <td class="text-center">1</td>
            <td class="text-center">0</td>
            <td class="text-center">0</td>

            <!-- Action -->
            <td class="text-center rsm-action-cell">
              <button class="btn btn-sm rsm-circle-btn btn-merchant-action">
                <img src="assets/img/icon/view1.svg" alt="More">

              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- FOOTER / PAGINATION -->
    <div class="rsm-pagination-component-container"></div>

    <script>
      // Load Pagination
      fetch('assets/partials/components/pagination.html')
        .then(response => response.text())
        .then(html => {
          document.querySelectorAll('.rsm-pagination-component-container').forEach(container => {
            if (container.innerHTML.trim() === '') {
              container.innerHTML = html;
            }
          });
        });
    </script>

    <!-- Container for the Modal Partial -->
    <div id="merchantModalContainer"></div>

    <script>
      // Load the modal partial dynamically
      fetch("assets/partials/data_incoming_mobile_sales_modal.html")
        .then((r) => r.text())
        .then((html) => {
          const container = document.getElementById("merchantModalContainer");
          if (!container) return;

          // Cleanup existing elements if they exist (to exist reuse issues)
          [
            "merchantDetailModal",
            "downlineModal",
            "merchantDetailModalDownline",
            "downlineTableModal",
            "edcCreditModal",
            "merchantActionTemplate",
          ].forEach((id) => {
            const el = document.getElementById(id);
            if (el) el.remove();
          });

          container.innerHTML = html;

          // Move ALL modals and templates to body
          // Select specifically by IDs we know, or all children that are modals/templates
          const idsToMove = [
            "#merchantDetailModal",
            "#downlineModal",
            "#merchantDetailModalDownline",
            "#downlineTableModal",
            "#edcCreditModal",
            "#merchantActionTemplate",
          ];

          idsToMove.forEach((selector) => {
            const el = container.querySelector(selector);
            if (el) document.body.appendChild(el);
          });

          // Execute scripts in partial
          const scripts = container.querySelectorAll("script");
          scripts.forEach((s) => {
            const ns = document.createElement("script");
            ns.textContent = s.textContent;
            document.body.appendChild(ns);
          });
        });
    </script>


  </div>
</body>

</html>